Linux上vi(vim)编辑器使用教程


vi(vim)是上Linux非常常用的编辑器，很多Linux发行版都默认安装了vi(vim)。vi(vim)命令繁多但是如果使用灵活之后将会大大提高效率。vi是“visual interface”的缩写，vim是vi IMproved(增强版的vi)。在一般的系统管理维护中vi就够用，如果想使用代码加亮的话可以使用vim。下面vps侦探整理一下vi的使用教程：包含vi的基本介绍、使用模式、文件的打开关闭保存、插入文本或新建行、移动光标、删除、恢复字符或行、搜索等等，算是一篇比较适合新手学习vi的教程。

vi有3个模式：插入模式、命令模式、低行模式。

插入模式：在此模式下可以输入字符，按ESC将回到命令模式。
命令模式：可以移动光标、删除字符等。
低行模式：可以保存文件、退出vi、设置vi、查找等功能(低行模式也可以看作是命令模式里的)。

一、打开文件、保存、关闭文件(vi命令模式下使用)

vi filename       //打开filename文件
:w       //保存文件
:w vpser.net //保存至vpser.net文件
:q          //退出编辑器，如果文件已修改请使用下面的命令
:q!        //退出编辑器，且不保存
:wq         //退出编辑器，且保存文件

二、插入文本或行(vi命令模式下使用，执行下面命令后将进入插入模式，按ESC键可退出插入模式)

a      //在当前光标位置的右边添加文本
i       //在当前光标位置的左边添加文本
A     //在当前行的末尾位置添加文本
I      //在当前行的开始处添加文本(非空字符的行首)
O     //在当前行的上面新建一行
o     //在当前行的下面新建一行
R    //替换(覆盖)当前光标位置及后面的若干文本
J    //合并光标所在行及下一行为一行(依然在命令模式)

三、移动光标(vi命令模式下使用)

1、使用上下左右方向键

2、命令模式下：h   向左、j   向下 、k   向上、l  向右。
空格键 向右、Backspace  向左、Enter  移动到下一行首、-  移动到上一行首。

按词移动光标
按下w (“word“) 使光标每次向右移动一个词
按下b (“back“) 使光标每次向左移动一个词
按下W或B ，使光标越过邻近的标点移动到下一个或前一个空白上
按下e (“end”) 使光标移动到当前词的最后一个字母上
◇ 移动到行的开头和结尾处
按下＾使光标移动到当前行的开头处。
按下$ 使光标移动到当前行的结尾处。
◇ 光标向下移动一行
按下Return键，使光标移动到下一行的开头处。向左移动光标
按下Backspace键，使光标向左移动一个字符。
◇ 向右移动光标
按下Spacebar键，使光标向右移动一个字符。
◇ 把光标移动到顶部
按下H (“high”)，使光标移动到屏幕的顶部。
◇ 把光标移动到中部
按下M (“middle”)，使光标移动到屏幕的中间。
◇ 把光标移动到底部
按下L (“low”)，使光标移动到屏幕的底部。
按句移动光标
Vi识别句子。在vi中，以！、或. 、或？、或两个空格结尾，vi就认为这是一
句。
◇ 用“（”（左括号）将光标移动到当前句开始
◇ 用“）”（右括号）将光标移动到下一句开始
按段定位光标
◇ vi 认为段的末尾必须是一个空行
按段移动
◇ { 光标移动到当前段的开始
◇ } 光标移动到下一段的开始
◇ 光标可按n｛、n｝移动（n是1、2、3、4等数字）。
如：3｛、4｝等。

% 匹配括号

卷动屏幕
当文本很长, 需快速滚动时，可用下列命令：
Control-F [Control键+ F 键] 屏幕上卷一整屏
Control-D 屏幕下卷半屏
Control-B 屏幕向后卷动一整屏
Control-U 屏幕向上卷动半屏
光标移动到指定的行
◇ 命令ng将光标移动到第n行
例111g将光标移动到第111行
命令G将光标移动到文件的最后一行。

四、删除、恢复字符或行(vi命令模式下使用)

x         //删除当前字符
nx         //删除从光标开始的n个字符
dd      //删除当前行
ndd   //向下删除当前行在内的n行
dg    //向下删除到文件结尾
u       //撤销上一步操作
U      //撤销对当前行的所有操作

五、搜索(vi命令模式下使用)

/vpser     //向光标下搜索vpser字符串
?vpser     //向光标上搜索vpser字符串
n           //向下搜索前一个搜素动作
N         //向上搜索前一个搜索动作

六、跳至指定行(vi命令模式下使用)

n+        //向下跳n行
n-         //向上跳n行
nG        //跳到行号为n的行
G           //跳至文件的底部

七、设置行号(vi命令模式下使用)

:set nu     //显示行号
:set nonu    //取消显示行号
:set showmode
:set ts=4

八、复制、粘贴(vi命令模式下使用)

yy    //将当前行复制到缓存区，也可以用 "ayy 复制，"a 为缓冲区，a也可以替换为a到z的任意字母，可以完成多个复制任务。
nyy   //将当前行向下n行复制到缓冲区，也可以用 "anyy 复制，"a 为缓冲区，a也可以替换为a到z的任意字母，可以完成多个复制任务。
yw    //复制从光标开始到词尾的字符。
nyw   //复制从光标开始的n个单词。
y^      //复制从光标到行首的内容。  VPS侦探
y$      //复制从光标到行尾的内容。
p        //粘贴剪切板里的内容在光标后，如果使用了前面的自定义缓冲区，建议使用"ap 进行粘贴。
P        //粘贴剪切板里的内容在光标前，如果使用了前面的自定义缓冲区，建议使用"aP 进行粘贴。

九、替换(vi命令模式下使用)

cNl  //替换N个字符
cW   //替换一个词
cc   //更改一行
c    //更改一行部分内容
s    //一个或N个字符替换一个字符
r    //替换一个字符

:s/old/new      //用new替换行中首次出现的old
:s/old/new/g         //用new替换行中所有的old
:n,m s/old/new/g     //用new替换从n到m行里所有的old
:%s/old/new/g      //用new替换当前文件里所有的old
:%s/^M//g (To get the ^M hold the control key, press V then M (Both while holding the control key) and the ^M will appear.)

十、编辑其他文件

:e otherfilename    //编辑文件名为otherfilename的文件。

十一、修改文件格式

:set fileformat=unix   //将文件修改为unix格式，如win下面的文本文件在linux下会出现^M。

总结：vi(vim)教程虽然有比较多的命令，但是只要勤加练习，相信你会很快的熟练掌握，同时也会给你的工作或学习带来更高的效率。当如果不知道自己处在什么模式时可以按2次Esc键即可回到命令模式，会有最后提醒一点：注意大小写！！！


VI:
Terminal too wide

stty -a
stty columns 80/132


以下列表提供对基本vi命令的一个方便的参考。
命令含义
vi filename 打开或创建文件
vi 打开新文件，以后再命名
vi-r filename 恢复被毁坏的文件
view filename 打开文件只读
光标命令
h 向左移动一个字符
j 向下移动一行
k 向上移动一行
l 向右移动一个字符
w 向右移动一个字
W 向右移动一个词（跳过标点符号）
b 向左移动一个词
B 向左移动一个词（跳过标点符号）
e 移动到当前词的结尾
Return 向下移动一行
Backspace 向左移动一个字符
Spacebar 向右移动一个字符
H 移动到屏幕顶部
M 移动到屏幕中部
L 移动到屏幕底部
Ctrl-F 向前翻页一屏
Ctrl-D 向前滚动半屏
Ctrl-B 向后翻页一屏
Ctrl-U 向后滚动半屏
插入字符和行
a 在光标右边插入字符
A 在行尾插入字符
i 在光标左边插入字符
I 在行首插入字符
o 在光标下面插入字符
O 在光标上面插入字符
更改文本
cw 更改光标右边的词（部分词）
cc 更改行
C 从光标处更改到行尾
s 从光标处向前用字符替换串
r 用另一个字符替换光标处的字符
r Return 断开行
J 合并当前行和下面行
xp 光标处字符与其右边字符颠倒
～ 更改字母的大小写（大写或小写）
u 撤销前一个命令
U 撤销对当前行所做的所有更改
: u 撤销前一个最后行命令
删除文本
x 删除光标处字符X 删除光标左边字符
dw 删除词（或光标右边的部分词）
dd 删除光标所在行
D 删除光标右边的部分行
dG 删除到文件结尾
d1G 从文件开始到光标处
: 5，10d 删除行5— 10
复制和移动文本
yy 移动或复制行
Y 移动或复制行
p 在当前行下面放置被复制或被删除的行
P 在当前行上面放置被复制或被删除的行
: 1,2 co 3 复制行1-2并放置到行3之后
: 4,5 m 6 移动行4-5并放置到行6之后
设置行号
: set nu 显示行号
:set nonu 隐藏行号
设置区分大小写
:set ic 查找应忽略大小写
:set noic 查找应区分大小写
查找一行
G 转向文件的最后一行
1G 转向文件的第一行
21G 转向第21行
查找和替换
／string 查找串
?String 向后查找串
n 沿着查找方向查找下一个出现的串
N 沿着查找方向查找前一个出现的串
清除屏幕
Ctrl-L 清除（刷新）杂乱的屏幕
将一个文件插入到另一个文件中
:r filename 在光标之后插入（读取）文件
:34 r filename 在34行之后插入文件
保存和退出
:w 保存更改（写缓冲区）
:w filename 将缓冲区写入命名的文件
:wq 保存更改并退出vi
ZZ 保存更改并退出vi
:q! 退出但不保存更改
:l1,l2 w filename 将文本中从行1到行2的内容保存到一个文件中。
